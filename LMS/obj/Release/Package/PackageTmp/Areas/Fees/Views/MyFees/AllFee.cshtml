@model IEnumerable<LMS.Models.StudentFee>
@{
    ViewBag.Title = "AllFee";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="breadcrumbs ace-save-state" id="breadcrumbs">
    <ul class="breadcrumb">
        <li>
            <i class="ace-icon fa fa-dashboard"></i>
            <a href="@Url.Action("Index","MyDashboard", new { area =""})">Dashboard</a>
        </li>
        <li class="active">My Fee Record</li>
    </ul><!-- /.breadcrumb -->
</div>
<div class="page-content">
    <div class="row">
        <div class="col-xs-12">
            <!-- PAGE CONTENT BEGINS -->
            <div class="page-header">
                <h1>
                    <a href="@Url.Action("Index","MyDashboard", new { area =""})" title="Back"><i class="fa fa-arrow-circle-o-left"></i> Back</a>
                    |
                    My Fee Record
                </h1>
            </div>
            <!-- div.table-responsive -->
            <!-- div.dataTables_borderWrap -->
            <h1 class="text-danger">@ViewBag.Error</h1>
            @Html.Raw(TempData["Sucess"])
            @Html.Raw(TempData["Failed"])
            <div>
                @foreach (var session in Model.GroupBy(t => t.SessionID))
                {

                    <div class="widget-box transparent">
                        <div class="widget-header widget-header-flat">
                            <h5 class="widget-title lighter">
                                <i class="ace-icon fa fa-book orange"></i>
                                @session.Select(t => t.Session.Session1).First() Fee Records.

                            </h5>

                            <div class="widget-toolbar">
                                <a href="#" data-action="collapse">
                                    <i class="ace-icon fa fa-chevron-up"></i>
                                </a>
                            </div>
                        </div>

                        <div class="widget-body" style="display: block;">
                            <div class="widget-main no-padding" style="overflow-y: scroll;">
                                <table class="table table-bordered table-striped">
                                    <thead class="thin-border-bottom">
                                        <tr>
                                            <th width="5%">S#</th>
                                            <th width="10%">
                                                Fee Head
                                            </th>
                                            <th width="10%">
                                                Amount
                                            </th>
                                            <th width="5%">Date of Payment</th>
                                            <th width="5%">Status</th>
                                            <td width="10%">Actions</td>
                                        </tr>
                                    </thead>

                                    <tbody>
                                        @{ int sno = 1;}
                                        @foreach (var item in Model.Where(t => t.SessionID == session.Key))
                                        {
                                            <tr>
                                                <td>@sno</td>
                                                <td>@Html.DisplayFor(modelItem => item.FeeHead.HeadName)</td>

                                                <td>
                                                    @Html.DisplayFor(modelItem => item.Amount)
                                                </td>
                                                <td>
                                                    @String.Format("{0:dd-MMM-yyyy}", item.ReceiveDate)
                                                </td>
                                                <td>
                                                    @if (item.IsPaid == true)
                                                    {
                                                        <span class="label label-white label-danger middle">Paid</span>
                                                    }
                                                    else
                                                    {
                                                        <span class="label label-white label-info middle">Pending</span>
                                                    }
                                                </td>
                                                <td>
                                                    @*<div class="btn-group">
                                                        <button data-toggle="dropdown" class="btn btn-info btn-xs dropdown-toggle">
                                                            Actions
                                                            <span class="ace-icon fa fa-caret-down icon-on-right"></span>
                                                        </button>

                                                        <ul class="dropdown-menu dropdown-info dropdown-menu-right">
                                                            <li>
                                                                @using (Html.BeginForm("DropCourse", "MyCourses", FormMethod.Post, new { @class = "dropform" }))
                                                                {
                                                                    <input type="hidden" name="SessionID" value="@item.SessionID" />
                                                                    <input type="hidden" name="CourseID" value="@item.CourseID" />
                                                                    <input type="submit" value="Submit" style="display:none">
                                                                }
                                                                <a href="#" class="dropCourseLink">Drop this course</a>
                                                            </li>

                                                            <li>
                                                                @using (Html.BeginForm("WithDrawCourse", "MyCourses", FormMethod.Post, new { @id = "withdrawform" }))
                                                                {
                                                                    <input type="hidden" name="SessionID" value="@item.SessionID" />
                                                                    <input type="hidden" name="CourseID" value="@item.CourseID" />
                                                                    <input type="submit" value="Submit" style="display:none">

                                                                }
                                                                <a href="#" id="withdrawCourseLink">Widraw this course</a>
                                                            </li>
                                                        </ul>
                                                    </div>*@
                                                </td>
                                            </tr>
                                            sno++;
                                        }
                                    </tbody>
                                </table>
                            </div><!-- /.widget-main -->
                        </div><!-- /.widget-body -->
                    </div>
                }
            </div>

        </div>

        <!-- PAGE CONTENT ENDS -->
    </div><!-- /.col -->
</div><!-- /.page-content -->

<script>
    $(document).ready(function () {
        $(".dropCourseLink").on("click", function (e) {
            e.preventDefault();
            $(this).prev(".dropform").submit();
        });
    });

    document.getElementById('withdrawCourseLink').addEventListener('click', function (e) {
        var Okay = confirm("Are you sure you want to withdraw this course?");
        if (Okay) {
            e.preventDefault();
            document.getElementById('withdrawform').submit();
        }
    });
</script>